# Basic ModSecurity configuration
SecRuleEngine On
SecRequestBodyAccess On
SecRequestBodyLimit 134217728
SecRequestBodyNoFilesLimit 131072
SecRequestBodyInMemoryLimit 131072

# Audit logging
SecAuditEngine RelevantOnly
SecAuditLog /var/log/modsecurity/audit.log
SecAuditLogFormat JSON
SecAuditLogType Serial
SecAuditLogParts ABCEFHJKZ

# OWASP CRS configuration
Include /etc/modsecurity.d/owasp-crs/crs-setup.conf
Include /etc/modsecurity.d/owasp-crs/rules/*.conf

# Custom rules (from mounted volume)
Include /etc/modsecurity.d/owasp-crs/rules/REQUEST-*.conf